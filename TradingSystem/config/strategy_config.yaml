# トレーディングシステム設定ファイル
# このファイルを編集することで、簡単に銘柄やパラメータを変更できます

# ==========================================
# バックテスト期間設定
# ==========================================
backtest_period:
  # 開始日（YYYY-MM-DD形式）
  start_date: "2025-11-01"

  # 終了日（YYYY-MM-DD形式）
  end_date: "2025-12-02"

# ==========================================
# バックテスト対象設定
# ==========================================
backtest_target:
  # バックテスト対象モード
  # - "portfolio": 下記のstocksに記載された銘柄のみでバックテスト（高速）
  # - "all_stocks": データベースの全銘柄でバックテスト（時間がかかる）
  mode: "portfolio"

# ==========================================
# 資金管理設定
# ==========================================
capital:
  # 各銘柄に配分する資金（円）
  per_stock: 3000000

  # 手数料率（片道、例: 0.001 = 0.1%）
  commission_rate: 0.001

# ==========================================
# 銘柄リスト（全99銘柄）
# ==========================================
# フォーマット: [銘柄コード, 銘柄名]
# 銘柄コードは東京証券取引所の場合「.T」サフィックス必須
stocks:
  # エネルギー・資源
  - ["1605.T", "INPEX"]
  - ["1925.T", "大和ハウス工業"]
  - ["1928.T", "積水ハウス"]

  # 食品
  - ["2502.T", "アサヒグループHD"]
  - ["2503.T", "キリンHD"]
  - ["2801.T", "キッコーマン"]
  - ["2802.T", "味の素"]
  - ["2914.T", "JT"]

  # 繊維・不動産
  - ["3382.T", "セブン&アイHD"]
  - ["3407.T", "旭化成"]

  # 医薬品
  - ["4063.T", "信越化学工業"]
  - ["4151.T", "協和キリン"]
  - ["4183.T", "三井化学"]
  - ["4188.T", "三菱ケミカルG"]
  - ["4324.T", "電通G"]
  - ["4452.T", "花王"]
  - ["4502.T", "武田薬品工業"]
  - ["4503.T", "アステラス製薬"]
  - ["4523.T", "エーザイ"]
  - ["4568.T", "第一三共"]
  - ["4578.T", "大塚HD"]
  - ["4704.T", "トレンドマイクロ"]
  - ["4901.T", "富士フイルム"]
  - ["4911.T", "資生堂"]

  # 石油・鉄鋼
  - ["5016.T", "JX金属"]
  - ["5020.T", "ENEOSホールディングス"]
  - ["5332.T", "TOTO"]
  - ["5401.T", "日本製鉄"]
  - ["5411.T", "JFEホールディングス"]

  # 非鉄金属
  - ["5706.T", "三井金属"]
  - ["5711.T", "三菱マテリアル"]
  - ["5713.T", "住友金属鉱山"]
  - ["5714.T", "DOWAホールディングス"]
  - ["5801.T", "古河電気工業"]
  - ["5802.T", "住友電気工業"]
  - ["5803.T", "フジクラ"]

  # 機械
  - ["6103.T", "オークマ"]
  - ["6146.T", "ディスコ"]
  - ["6301.T", "小松製作所"]
  - ["6305.T", "日立建機"]
  - ["6367.T", "ダイキン工業"]
  - ["6501.T", "日立製作所"]
  - ["6503.T", "三菱電機"]
  - ["6506.T", "安川電機"]
  - ["6594.T", "ニデック"]

  # 電気機器
  - ["6702.T", "富士通"]
  - ["6723.T", "ルネサスエレクトロニクス"]
  - ["6752.T", "パナソニック"]
  - ["6758.T", "ソニーグループ"]
  - ["6762.T", "TDK"]
  - ["6857.T", "アドバンテスト"]
  - ["6861.T", "キーエンス"]
  - ["6902.T", "デンソー"]
  - ["6920.T", "レーザーテック"]
  - ["6954.T", "ファナック"]
  - ["6976.T", "太陽誘電"]
  - ["6981.T", "村田製作所"]
  - ["285A.T", "キオクシア"]

  # 輸送用機器
  - ["7011.T", "三菱重工業"]
  - ["7012.T", "川崎重工業"]
  - ["7013.T", "IHI"]
  - ["7201.T", "日産自動車"]
  - ["7203.T", "トヨタ自動車"]
  - ["7261.T", "マツダ"]
  - ["7267.T", "ホンダ"]
  - ["7269.T", "スズキ"]
  - ["7270.T", "SUBARU"]
  - ["7741.T", "HOYA"]
  - ["7974.T", "任天堂"]

  # 商社
  - ["8001.T", "伊藤忠商事"]
  - ["8002.T", "丸紅"]
  - ["8015.T", "豊田通商"]
  - ["8031.T", "三井物産"]
  - ["8035.T", "東京エレクトロン"]
  - ["8053.T", "住友商事"]
  - ["8058.T", "三菱商事"]
  - ["8267.T", "イオン"]

  # 金融
  - ["8306.T", "三菱UFJフィナンシャル・グループ"]
  - ["8308.T", "りそなHD"]
  - ["8316.T", "三井住友フィナンシャルグループ"]
  - ["8354.T", "ふくおかフィナンシャルグループ"]
  - ["8411.T", "みずほフィナンシャルグループ"]
  - ["8604.T", "野村ホールディングス"]
  - ["8750.T", "第一生命ホールディングス"]
  - ["8766.T", "東京海上ホールディングス"]
  - ["8801.T", "三井不動産"]
  - ["8802.T", "三菱地所"]
  - ["8830.T", "住友不動産"]

  # 海運・通信
  - ["9101.T", "日本郵船"]
  - ["9104.T", "商船三井"]
  - ["9107.T", "川崎汽船"]
  - ["9432.T", "NTT"]
  - ["9433.T", "KDDI"]
  - ["9434.T", "ソフトバンク"]

  # 電力・その他
  - ["9501.T", "東京電力ホールディングス"]
  - ["9502.T", "中部電力"]
  - ["9503.T", "関西電力"]
  - ["9983.T", "ファーストリテイリング"]
  - ["9984.T", "ソフトバンクグループ"]

# ==========================================
# ORB戦略パラメータ
# ==========================================
orb_strategy:
  # オープンレンジ期間（JST時刻）
  # この期間の高値・安値をブレイクアウトの基準とする
  open_range:
    # 開始時刻（HH:MM形式）
    start_time: "09:07"

    # 終了時刻（HH:MM形式）
    end_time: "09:12"

  # エントリー期間（JST時刻）
  # この期間内でのみエントリー可能
  entry_window:
    # 開始時刻（HH:MM形式）
    start_time: "09:12"

    # 終了時刻（HH:MM形式）
    end_time: "11:00"

  # ==========================================
  # エントリーフィルタ（市場環境チェック）
  # ==========================================
  entry_filters:
    # 日経先物下落フィルタ
    nikkei_futures_filter:
      # フィルタの有効/無効
      enabled: false

      # 日経先物のRICコード（日経225先物 Generic）
      # JNIc1 = 利用可能な唯一の先物データ
      symbol: "JNIc1"

      # 代替シンボル（先物データが取得できない場合に使用）
      # 注: 現在の契約では代替シンボルも利用不可のため、フィルターは無効化される
      fallback_symbol: "JNIc1"

      # 下落率閾値（%、マイナス値で指定）
      # 前日NY時間での下落率がこの値を下回った場合、エントリーを見送る
      threshold: -2.0

      # 参照時刻（前日の何時のデータと比較するか、UTC）
      # 例: 21:00 UTC = 日本時間 翌6:00（NYクローズ後）
      reference_time_utc: "21:00"

  # 強制決済時刻（JST時刻）
  # この時刻に達すると全ポジションを強制的に決済
  force_exit_time: "15:30"

  # 利益目標（パーセンテージ、例: 0.04 = 4%）
  profit_target: 0.04

  # ==========================================
  # 損切り設定（拡張版）
  # ==========================================
  stop_loss:
    # モード選択: "fixed", "atr", "atr_adaptive"
    # fixed: 固定値のストップロス（従来通り）
    # atr: ATR（Average True Range）ベースの動的ストップロス
    # atr_adaptive: ボラティリティレベルに応じて自動調整
    mode: "fixed"  # ← ここで切り替え

    # 固定モード設定
    fixed:
      value: 0.0075  # 0.75%（従来のデフォルト値）

    # ATRモード設定
    atr:
      period: 14  # ATR計算期間（日）
      multiplier: 0.75  # ATR倍率（通常は0.5〜1.0）
      min_stop: 0.005  # 最小ストップ（0.5%）
      max_stop: 0.03   # 最大ストップ（3.0%）

    # ATR適応型モード設定
    atr_adaptive:
      period: 14
      # ボラティリティレベル別の倍率
      multipliers:
        low: 0.5      # 低ボラティリティ時（ATR < 1.5%）
        medium: 0.75  # 中ボラティリティ時（ATR 1.5-2.5%）
        high: 1.0     # 高ボラティリティ時（ATR 2.5-4.0%）
        extreme: 1.25 # 極度のボラティリティ時（ATR > 4.0%）
      # ボラティリティの閾値（ATR%）
      thresholds:
        low_medium: 1.5     # 低→中の境界
        medium_high: 2.5    # 中→高の境界
        high_extreme: 4.0   # 高→極度の境界
      min_stop: 0.005  # 最小ストップ（0.5%）
      max_stop: 0.04   # 最大ストップ（4.0%）

    # 銘柄別の上書き設定（オプション）
    # 特定の銘柄に対して倍率を調整可能
    symbol_overrides:
      "9984.T":  # ソフトバンクG（高ボラティリティ銘柄）
        multiplier: 1.2  # 通常より広め（20%増し）
      "9432.T":  # NTT（低ボラティリティ銘柄）
        multiplier: 0.4  # 通常より狭め（60%減）

# ==========================================
# データ取得設定
# ==========================================
data:
  # データ間隔（1min, 5min, 10min, 30min, 1h等）
  interval: "1min"

  # Refinitiv API設定
  refinitiv:
    # APIキー（環境変数 REFINITIV_APP_KEY からも読み込み可能）
    app_key: "1475940198b04fdab9265b7892546cc2ead9eda6"

    # データキャッシュを使用するか
    use_cache: true

# ==========================================
# データベース設定
# ==========================================
database:
  # ホスト名（環境変数 DB_HOST からも読み込み可能）
  host: "localhost"

  # ポート番号
  port: 5432

  # データベース名
  database: "market_data"

  # ユーザー名（環境変数 DB_USER からも読み込み可能）
  user: "postgres"

  # パスワード（環境変数 DB_PASSWORD からも読み込み可能）
  password: "postgres"

# ==========================================
# 市場環境フィルター
# ==========================================
market_filter:
  # フィルターを有効にするか
  enabled: true

  # 監視する指数（.N225=日経平均, .TOPX=TOPIX）
  index_symbol: ".N225"

  # トレンド判定の閾値（例: 0.015 = 1.5%）
  # これを超える上昇/下落の日は逆張りポジションを制限
  threshold: 0.015

  # 何日前との比較か（通常は1日=前日比）
  lookback_days: 1

# ==========================================
# レポート設定
# ==========================================
reports:
  # レポート出力先ディレクトリ
  output_dir: "Output"

  # 日次レポートを生成するか
  generate_daily: true

  # チャートを生成するか
  generate_charts: true

  # サマリーレポートを生成するか
  generate_summary: true

  # レポート内の通貨フォーマット
  currency_format: "¥{:,.0f}"

  # パーセンテージフォーマット
  percentage_format: "{:.2f}%"

# ==========================================
# ログ設定
# ==========================================
logging:
  # ログレベル（DEBUG, INFO, WARNING, ERROR）
  level: "INFO"

  # ログファイルに出力するか
  to_file: true

  # ログファイルパス
  file_path: "Output/trading_system.log"

# ==========================================
# 備考
# ==========================================
# - 銘柄の追加: stocks セクションに [銘柄コード, 銘柄名] を追加
# - パラメータ調整: orb_strategy セクションの値を変更
# - 期間変更: backtest_period セクションの日付を変更
# - 資金変更: capital.per_stock の値を変更
