# トレーディングシステム設定ファイル
# このファイルを編集することで、簡単に銘柄やパラメータを変更できます

# ==========================================
# バックテスト期間設定
# ==========================================
backtest_period:
  # 開始日（YYYY-MM-DD形式）
  start_date: "2025-11-01"

  # 終了日（YYYY-MM-DD形式）
  end_date: "2025-12-02"

# ==========================================
# バックテスト対象設定
# ==========================================
backtest_target:
  # バックテスト対象モード
  # - "portfolio": 下記のstocksに記載された銘柄のみでバックテスト（高速）
  # - "all_stocks": データベースの全銘柄でバックテスト（時間がかかる）
  mode: "portfolio"

# ==========================================
# 資金管理設定
# ==========================================
capital:
  # 各銘柄に配分する資金（円）
  per_stock: 3000000

  # 手数料率（片道、例: 0.001 = 0.1%）
  commission_rate: 0.001

# ==========================================
# 銘柄リスト
# ==========================================
# フォーマット: [銘柄コード, 銘柄名]
# 銘柄コードは東京証券取引所の場合「.T」サフィックス必須
# 例: "6762.T" = TDK株式会社
stocks:
  # テクノロジーセクター
  - ["6762.T", "TDK"]
  - ["6857.T", "アドバンテスト"]
  #- ["6758.T", "ソニー"]
  - ["9984.T", "ソフトバンクグループ"]
  #- ["8035.T", "東京エレクトロン"]
  - ["6920.T", "レーザーテック"]
  - ["6146.T", "ディスコ"]
  #- ["285A.T", "キオクシア"]
  - ["6594.T", "ニデック"]
  #- ["6981.T", "村田製作所"]
  #- ["6861.T", "キーエンス"]
  - ["7741.T", "HOYA"]

  # 海運セクター
  #- ["9101.T", "日本郵船"]
  #- ["9104.T", "商船三井"]
  - ["9107.T", "川崎汽船"]

  # 商社セクター
  #- ["8058.T", "三菱商事"]
  #- ["8001.T", "伊藤忠商事"]
  - ["8015.T", "豊田通商"]

  # エネルギーセクター
  #- ["1605.T", "INPEX"]

  # 鉄鋼セクター
  #- ["5401.T", "日本製鉄"]

  # 通信セクター
  - ["9433.T", "KDDI"]
  #- ["9432.T", "NTT"]

  # 金融セクター
  #- ["8306.T", "MUFG"]
  #- ["8316.T", "SMBC"]
  #- ["8411.T", "みずほ"]
  #- ["8766.T", "東京海上"]

  # 自動車セクター
  #- ["7203.T", "トヨタ"]
  #- ["7267.T", "ホンダ"]

  # 製造業セクター
  #- ["6367.T", "ダイキン"]
  #- ["6506.T", "安川電機"]
  #- ["6752.T", "パナソニック"]
  #- ["6954.T", "ファナック"]
  - ["6503.T", "三菱電機"]

  # 非鉄金属セクター
  #- ["5016.T", "JX金属"]
  - ["5706.T", "三井金属"]
  - ["5711.T", "三菱マテリアル"]
  - ["5801.T", "古河電気工業"]
  - ["5803.T", "フジクラ"]
  - ["5802.T", "住友電気工業"]

  # 重工業セクター
  - ["7011.T", "三菱重工業"]
  #- ["7012.T", "川崎重工"]
  - ["7013.T", "IHI"]

# ==========================================
# ORB戦略パラメータ
# ==========================================
orb_strategy:
  # オープンレンジ期間（JST時刻）
  # この期間の高値・安値をブレイクアウトの基準とする
  open_range:
    # 開始時刻（HH:MM形式）
    start_time: "09:07"

    # 終了時刻（HH:MM形式）
    end_time: "09:12"

  # エントリー期間（JST時刻）
  # この期間内でのみエントリー可能
  entry_window:
    # 開始時刻（HH:MM形式）
    start_time: "09:12"

    # 終了時刻（HH:MM形式）
    end_time: "11:00"

  # ==========================================
  # エントリーフィルタ（市場環境チェック）
  # ==========================================
  entry_filters:
    # 日経先物下落フィルタ
    nikkei_futures_filter:
      # フィルタの有効/無効
      enabled: false

      # 日経先物のRICコード（日経225先物 Generic）
      # JNIc1 = 利用可能な唯一の先物データ
      symbol: "JNIc1"

      # 代替シンボル（先物データが取得できない場合に使用）
      # 注: 現在の契約では代替シンボルも利用不可のため、フィルターは無効化される
      fallback_symbol: "JNIc1"

      # 下落率閾値（%、マイナス値で指定）
      # 前日NY時間での下落率がこの値を下回った場合、エントリーを見送る
      threshold: -2.0

      # 参照時刻（前日の何時のデータと比較するか、UTC）
      # 例: 21:00 UTC = 日本時間 翌6:00（NYクローズ後）
      reference_time_utc: "21:00"

  # 強制決済時刻（JST時刻）
  # この時刻に達すると全ポジションを強制的に決済
  force_exit_time: "15:30"

  # 利益目標（パーセンテージ、例: 0.04 = 4%）
  profit_target: 0.04

  # ==========================================
  # 損切り設定（拡張版）
  # ==========================================
  stop_loss:
    # モード選択: "fixed", "atr", "atr_adaptive"
    # fixed: 固定値のストップロス（従来通り）
    # atr: ATR（Average True Range）ベースの動的ストップロス
    # atr_adaptive: ボラティリティレベルに応じて自動調整
    mode: "fixed"  # ← ここで切り替え

    # 固定モード設定
    fixed:
      value: 0.0075  # 0.75%（従来のデフォルト値）

    # ATRモード設定
    atr:
      period: 14  # ATR計算期間（日）
      multiplier: 0.75  # ATR倍率（通常は0.5〜1.0）
      min_stop: 0.005  # 最小ストップ（0.5%）
      max_stop: 0.03   # 最大ストップ（3.0%）

    # ATR適応型モード設定
    atr_adaptive:
      period: 14
      # ボラティリティレベル別の倍率
      multipliers:
        low: 0.5      # 低ボラティリティ時（ATR < 1.5%）
        medium: 0.75  # 中ボラティリティ時（ATR 1.5-2.5%）
        high: 1.0     # 高ボラティリティ時（ATR 2.5-4.0%）
        extreme: 1.25 # 極度のボラティリティ時（ATR > 4.0%）
      # ボラティリティの閾値（ATR%）
      thresholds:
        low_medium: 1.5     # 低→中の境界
        medium_high: 2.5    # 中→高の境界
        high_extreme: 4.0   # 高→極度の境界
      min_stop: 0.005  # 最小ストップ（0.5%）
      max_stop: 0.04   # 最大ストップ（4.0%）

    # 銘柄別の上書き設定（オプション）
    # 特定の銘柄に対して倍率を調整可能
    symbol_overrides:
      "9984.T":  # ソフトバンクG（高ボラティリティ銘柄）
        multiplier: 1.2  # 通常より広め（20%増し）
      "9432.T":  # NTT（低ボラティリティ銘柄）
        multiplier: 0.4  # 通常より狭め（60%減）

# ==========================================
# データ取得設定
# ==========================================
data:
  # データ間隔（1min, 5min, 10min, 30min, 1h等）
  interval: "1min"

  # Refinitiv API設定
  refinitiv:
    # APIキー（環境変数 REFINITIV_APP_KEY からも読み込み可能）
    app_key: "1475940198b04fdab9265b7892546cc2ead9eda6"

    # データキャッシュを使用するか
    use_cache: true

# ==========================================
# データベース設定
# ==========================================
database:
  # ホスト名（環境変数 DB_HOST からも読み込み可能）
  host: "localhost"

  # ポート番号
  port: 5432

  # データベース名
  database: "market_data"

  # ユーザー名（環境変数 DB_USER からも読み込み可能）
  user: "postgres"

  # パスワード（環境変数 DB_PASSWORD からも読み込み可能）
  password: "postgres"

# ==========================================
# 市場環境フィルター
# ==========================================
market_filter:
  # フィルターを有効にするか
  enabled: true

  # 監視する指数（.N225=日経平均, .TOPX=TOPIX）
  index_symbol: ".N225"

  # トレンド判定の閾値（例: 0.015 = 1.5%）
  # これを超える上昇/下落の日は逆張りポジションを制限
  threshold: 0.015

  # 何日前との比較か（通常は1日=前日比）
  lookback_days: 1

# ==========================================
# レポート設定
# ==========================================
reports:
  # レポート出力先ディレクトリ
  output_dir: "Output"

  # 日次レポートを生成するか
  generate_daily: true

  # チャートを生成するか
  generate_charts: true

  # サマリーレポートを生成するか
  generate_summary: true

  # レポート内の通貨フォーマット
  currency_format: "¥{:,.0f}"

  # パーセンテージフォーマット
  percentage_format: "{:.2f}%"

# ==========================================
# ログ設定
# ==========================================
logging:
  # ログレベル（DEBUG, INFO, WARNING, ERROR）
  level: "INFO"

  # ログファイルに出力するか
  to_file: true

  # ログファイルパス
  file_path: "Output/trading_system.log"

# ==========================================
# 備考
# ==========================================
# - 銘柄の追加: stocks セクションに [銘柄コード, 銘柄名] を追加
# - パラメータ調整: orb_strategy セクションの値を変更
# - 期間変更: backtest_period セクションの日付を変更
# - 資金変更: capital.per_stock の値を変更
